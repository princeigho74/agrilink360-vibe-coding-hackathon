<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>AgriLink360 ‚Äî Demo</title>

  <!-- Tailwind Play CDN for quick styling -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* Small custom tweaks */
    html,body,#root { height: 100%; }
    body { font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
    .fade-enter { opacity: 0; transform: translateY(6px); }
    .fade-enter-active { opacity: 1; transform: translateY(0); transition: all 180ms ease-out; }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <!-- React (UMD) -->
  <script crossorigin src="https://unpkg.com/react@17/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.development.js"></script>
  <!-- Babel for JSX in browser (fine for demo/hackathon) -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <script type="text/babel">
  const { useState, useEffect } = React;

  /******* Mock data *******/
  const FARMS = [
    { id: 1, crop: "Maize", quantity: "100kg", location: "Lagos", price: "$50", desc: "Freshly harvested yellow maize." },
    { id: 2, crop: "Tomatoes", quantity: "200kg", location: "Abuja", price: "$80", desc: "Ripe tomatoes from local farms." },
    { id: 3, crop: "Beans", quantity: "150kg", location: "Kano", price: "$65", desc: "Protein-rich beans, well-dried." }
  ];

  /******* Small UI components *******/

  function Header() {
    return (
      <header className="bg-white shadow-sm p-4 flex items-center justify-between">
        <div className="flex items-center space-x-3">
          <div className="w-10 h-10 rounded-full bg-green-600 flex items-center justify-center text-white font-bold">A</div>
          <div>
            <h1 className="text-lg font-bold">AgriLink360</h1>
            <p className="text-xs text-gray-500">From Farm to Table ‚Äî Zero Hunger</p>
          </div>
        </div>
        <nav className="text-sm text-gray-600">
          <span className="mr-4">Demo</span>
        </nav>
      </header>
    );
  }

  function Landing({ onStart }) {
    return (
      <div className="min-h-screen flex flex-col items-center justify-center bg-gradient-to-b from-green-600 to-green-500 text-white p-6">
        <h2 className="text-4xl font-extrabold mb-3">üåç AgriLink360</h2>
        <p className="max-w-xl text-center mb-6">Connecting farmers directly with buyers, preventing spoilage with IoT alerts, and helping communities access affordable food.</p>
        <div className="flex space-x-3">
          <button onClick={onStart} className="px-6 py-3 bg-white text-green-700 rounded-lg font-semibold shadow">Try Demo</button>
          <a className="px-6 py-3 border border-white rounded-lg text-white text-sm flex items-center" href="#how" onClick={(e)=>{e.preventDefault(); onStart();}}>Preview</a>
        </div>
        <p className="text-xs opacity-90 mt-6">Hackathon demo ‚Äî no backend required. All interactions simulated.</p>
      </div>
    );
  }

  function FarmCard({ farm, onMatch }) {
    return (
      <div className="bg-white p-4 rounded-lg shadow-sm border">
        <div className="flex items-start justify-between">
          <div>
            <h3 className="font-bold text-lg">{farm.crop}</h3>
            <p className="text-sm text-gray-600 mt-1">{farm.desc}</p>
            <div className="mt-3 text-sm text-gray-700">
              <div><strong>Quantity:</strong> {farm.quantity}</div>
              <div><strong>Location:</strong> {farm.location}</div>
              <div><strong>Price:</strong> {farm.price}</div>
            </div>
          </div>
          <div className="flex flex-col items-end">
            <button onClick={() => onMatch(farm)} className="px-3 py-2 bg-green-600 text-white rounded-md shadow hover:bg-green-700">Match Buyer</button>
            <button className="mt-3 px-2 py-1 text-xs text-gray-500 border rounded">Details</button>
          </div>
        </div>
      </div>
    );
  }

  function AlertToast({ message, onClose }) {
    useEffect(() => {
      const t = setTimeout(onClose, 8000);
      return () => clearTimeout(t);
    }, []);
    return (
      <div className="fixed right-4 bottom-4 max-w-xs bg-yellow-50 border border-yellow-400 text-yellow-900 p-4 rounded shadow-lg">
        <div className="flex justify-between items-start">
          <div>
            <strong className="block">‚ö†Ô∏è Storage Alert</strong>
            <p className="text-sm mt-1">{message}</p>
          </div>
          <button onClick={onClose} className="ml-4 text-sm px-2 py-1 bg-yellow-600 text-white rounded">Close</button>
        </div>
      </div>
    );
  }

  function Modal({ open, title, children, onClose }) {
    if (!open) return null;
    return (
      <div className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 p-4">
        <div className="bg-white rounded-lg shadow-lg max-w-lg w-full overflow-hidden">
          <div className="p-4 border-b flex justify-between items-center">
            <h4 className="font-semibold">{title}</h4>
            <button onClick={onClose} className="text-gray-500 hover:text-gray-700">‚úï</button>
          </div>
          <div className="p-4">
            {children}
          </div>
        </div>
      </div>
    );
  }

  /******* Main dashboard *******/
  function Dashboard() {
    const [farms] = useState(FARMS);
    const [alertShown, setAlertShown] = useState(false);
    const [modal, setModal] = useState({ open: false, farm: null, buyer: null, status: null });

    function onMatch(farm) {
      // simulate matching logic and show modal with options
      const buyers = [
        { id: "b1", name: "School A (Lagos)", distance: "10 km", contact: "school-a@example.org" },
        { id: "b2", name: "Market Vendor (Lagos)", distance: "8 km", contact: "vendor-lagos@example.org" }
      ];
      setModal({ open: true, farm, buyer: buyers[0], status: null });
    }

    function confirmMatch() {
      // simulate success
      setModal(m => ({ ...m, status: 'success' }));
      setTimeout(() => setModal({ open: false, farm: null, buyer: null, status: null }), 1800);
    }

    return (
      <div className="min-h-screen">
        <Header />
        <main className="p-6">
          <section className="max-w-6xl mx-auto">
            <div className="flex flex-col md:flex-row md:items-center md:justify-between mb-6">
              <h2 className="text-2xl font-bold">Available Harvests</h2>
              <div className="text-sm text-gray-600">Showing local harvests across regions</div>
            </div>

            <div className="grid gap-4 md:grid-cols-3 mb-6">
              {farms.map(f => <FarmCard key={f.id} farm={f} onMatch={onMatch} />)}
            </div>

            <div className="mt-6">
              <button onClick={() => setAlertShown(true)} className="px-4 py-2 bg-red-600 text-white rounded shadow">Simulate IoT Spoilage Alert</button>
            </div>

            <div className="mt-10 p-4 bg-white rounded-lg shadow-sm">
              <h3 className="font-semibold mb-2">How this demo maps to the hackathon:</h3>
              <ul className="text-sm text-gray-700 list-disc pl-5">
                <li>Farmer ‚Üí Buyer matching (simulated)</li>
                <li>IoT Spoilage alerts (simulated toast)</li>
                <li>Mobile-first UI; ready to integrate IntaSend payments</li>
              </ul>
            </div>
          </section>
        </main>

        {/* Modal for Match Buyer */}
        <Modal open={modal.open} title={modal.farm ? `Match Buyer: ${modal.farm.crop}` : 'Match Buyer'} onClose={() => setModal({ open: false, farm: null, buyer: null, status: null })}>
          {modal.status === 'success' ? (
            <div className="text-center py-6">
              <div className="text-green-600 text-3xl mb-2">‚úîÔ∏è</div>
              <p className="font-semibold">Buyer matched successfully!</p>
              <p className="text-sm text-gray-600 mt-2">A confirmation has been sent to the buyer. Payment and delivery flows are handled via IntaSend in production.</p>
            </div>
          ) : (
            <>
              <p className="text-sm text-gray-700 mb-4">We found a good match. Confirm to connect the buyer with the farmer.</p>
              <div className="border rounded p-3 bg-gray-50 mb-4">
                <div className="font-semibold">{modal.buyer?.name}</div>
                <div className="text-xs text-gray-600">{modal.buyer?.distance} ‚Ä¢ {modal.buyer?.contact}</div>
              </div>
              <div className="flex justify-end space-x-3">
                <button onClick={() => setModal({ open: false, farm: null, buyer: null, status: null })} className="px-3 py-2 border rounded">Cancel</button>
                <button onClick={confirmMatch} className="px-4 py-2 bg-green-600 text-white rounded">Confirm Match</button>
              </div>
            </>
          )}
        </Modal>

        {/* IoT Alert toast */}
        {alertShown && <AlertToast message="Maize in Lagos at risk of spoilage! Take action: move to cooler storage or sell quickly." onClose={() => setAlertShown(false)} />}

        <footer className="p-4 text-center text-xs text-gray-500">
          AgriLink360 ‚Äî Hackathon demo ‚Ä¢ Zero Hunger ‚Ä¢ Built for Africa
        </footer>
      </div>
    );
  }

  // App wrapper: landing -> dashboard
  function App() {
    const [started, setStarted] = useState(false);

    return started ? <Dashboard /> : <Landing onStart={() => setStarted(true)} />;
  }

  ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
